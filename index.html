<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="IN FOCO NETWORK - Conecte-se, compartilhe e cres√ßa com nossa comunidade de membros e eventos">
    <meta name="keywords" content="rede, membros, eventos, networking, comunidade, IN FOCO">
    <title>NETWORK IN FOCO EVENTOS - Rede de Membros e Eventos</title>
    <style>
        /* (MANTENHA TODOS OS ESTILOS ANTERIORES) */
        /* Os mesmos estilos do c√≥digo anterior... */
        
        /* Adicione estes estilos extras */
        .sync-status {
            position: fixed;
            top: 10px;
            left: 10px;
            background: var(--secondary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .sync-status.offline {
            background: var(--accent-color);
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            color: white;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <!-- Sync Status -->
    <div class="sync-status" id="syncStatus">
        <span>üîµ</span> Conectado
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1> <span>NETWORK IN FOCO EVENTOS V4</span> </h1>
                </div>
                <button class="mobile-menu-btn">‚ò∞</button>
                <nav>
                    <ul>
                        <li><a href="#" class="active">In√≠cio</a></li>
                        <li><a href="#membros">Membros</a></li>
                        <li><a href="#eventos">Eventos</a></li>
                        <li><a href="#cadastro">Cadastro</a></li>
                        <li><a href="#interacao">Intera√ß√£o</a></li>
                        <li><a href="#contato">Contato</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h2>Conecte-se. Compartilhe. Cres√ßa.</h2>
            <p>Uma plataforma para cadastrar membros da sua rede e divulgar eventos de forma eficiente.</p>
            <a href="#cadastro" class="btn">Cadastrar Membro</a>
            <a href="#eventos" class="btn btn-secondary">Ver Eventos</a>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Members Section -->
        <section id="membros">
            <h2 class="section-title">Nossos Membros</h2>
            <div class="cards-grid" id="members-list">
                <!-- Members will be dynamically added here -->
            </div>
        </section>

        <!-- Events Section -->
        <section id="eventos">
            <h2 class="section-title">Pr√≥ximos Eventos</h2>
            <div class="cards-grid" id="events-list">
                <!-- Events will be dynamically added here -->
            </div>
        </section>

        <!-- Registration Section -->
        <section id="cadastro">
            <h2 class="section-title">Cadastro</h2>
            <div class="tabs">
                <div class="tab active" data-tab="member">Cadastrar Membro</div>
                <div class="tab" data-tab="event">Cadastrar Evento</div>
            </div>

            <div class="tab-content active" id="member-form">
                <div class="form-container">
                    <form id="memberRegistrationForm">
                        <div class="image-upload-container">
                            <div class="image-preview" id="memberPhotoPreview">
                                <div class="placeholder">Foto do Membro</div>
                            </div>
                            <input type="file" id="memberPhoto" class="image-upload-input" accept="image/*">
                            <label for="memberPhoto" class="image-upload-btn">Selecionar Foto</label>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="memberName">Nome Completo *</label>
                                <input type="text" id="memberName" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="memberEmail">E-mail *</label>
                                <input type="email" id="memberEmail" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="memberPhone">Telefone</label>
                                <input type="tel" id="memberPhone" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="memberRole">Cargo/Fun√ß√£o *</label>
                                <input type="text" id="memberRole" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="memberBio">Biografia/Descri√ß√£o *</label>
                            <textarea id="memberBio" class="form-control" rows="4" required></textarea>
                        </div>
                        <button type="submit" class="btn" id="memberSubmitBtn">
                            <span>Cadastrar Membro</span>
                            <div class="btn-loading" style="display: none;">Enviando...</div>
                        </button>
                    </form>
                </div>
            </div>

            <div class="tab-content" id="event-form">
                <div class="form-container">
                    <form id="eventRegistrationForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="eventTitle">T√≠tulo do Evento *</label>
                                <input type="text" id="eventTitle" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="eventDate">Data do Evento *</label>
                                <input type="date" id="eventDate" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="eventTime">Hor√°rio *</label>
                                <input type="time" id="eventTime" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="eventLocation">Local *</label>
                                <input type="text" id="eventLocation" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="eventDescription">Descri√ß√£o do Evento *</label>
                            <textarea id="eventDescription" class="form-control" rows="4" required></textarea>
                        </div>
                        <button type="submit" class="btn" id="eventSubmitBtn">
                            <span>Cadastrar Evento</span>
                            <div class="btn-loading" style="display: none;">Enviando...</div>
                        </button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Confirmar Exclus√£o</h3>
            </div>
            <div class="modal-body">
                <p id="modalMessage">Tem certeza que deseja excluir este item?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modalCancel">Cancelar</button>
                <button class="btn btn-danger" id="modalConfirm">Excluir</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer id="contato">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Sobre N√≥s</h3>
                    <p>NETWORK IN FOCO EVENTOS √© uma plataforma dedicada a conectar pessoas e promover eventos que fazem a diferen√ßa.</p>
                </div>
                <div class="footer-section">
                    <h3>Contato</h3>
                    <p>Email: networkinfoco@gmail.com</p>
                    <p>Telefone: (11) 99999-9999</p>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook">FB</a>
                        <a href="https://www.instagram.com/networkinfoco?igsh=NGdzNmU0aXNoMGJt" aria-label="Instagram">IG</a>
                        <a href="#" aria-label="Twitter">TW</a>
                        <a href="#" aria-label="LinkedIn">LI</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Links R√°pidos</h3>
                    <p><a href="#membros">Membros</a></p>
                    <p><a href="#eventos">Eventos</a></p>
                    <p><a href="#cadastro">Cadastro</a></p>
                    <p><a href="#interacao">Intera√ß√£o</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 NETWORK IN FOCO EVENTOS. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
        // ========== CONFIGURA√á√ÉO DO GOOGLE SHEETS ==========
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbwQdCcz6VY6L0bXwQ8WZ8Q7Q5h5Q5b5q5q5q5q5q5q5q5q5q5q5q5q/exec';
        
        // ========== VARI√ÅVEIS GLOBAIS ==========
        let members = [];
        let events = [];
        let isOnline = true;

        // ========== DOM ELEMENTS ==========
        const membersList = document.getElementById('members-list');
        const eventsList = document.getElementById('events-list');
        const memberForm = document.getElementById('memberRegistrationForm');
        const eventForm = document.getElementById('eventRegistrationForm');
        const syncStatus = document.getElementById('syncStatus');
        const memberSubmitBtn = document.getElementById('memberSubmitBtn');
        const eventSubmitBtn = document.getElementById('eventSubmitBtn');

        // ========== FUN√á√ïES DO GOOGLE SHEETS ==========

        // Fun√ß√£o para carregar membros do Google Sheets
        async function loadMembers() {
            try {
                showLoading('Carregando membros...');
                const response = await fetch(`${SHEET_URL}?action=getMembers`);
                const data = await response.json();
                
                if (data.success) {
                    members = data.data;
                    renderMembers();
                    updateSyncStatus(true);
                } else {
                    throw new Error('Erro ao carregar membros');
                }
            } catch (error) {
                console.error('Erro ao carregar membros:', error);
                updateSyncStatus(false);
                // Tenta carregar do localStorage como fallback
                loadFromLocalStorage();
            } finally {
                hideLoading();
            }
        }

        // Fun√ß√£o para carregar eventos do Google Sheets
        async function loadEvents() {
            try {
                showLoading('Carregando eventos...');
                const response = await fetch(`${SHEET_URL}?action=getEvents`);
                const data = await response.json();
                
                if (data.success) {
                    events = data.data;
                    renderEvents();
                    updateSyncStatus(true);
                } else {
                    throw new Error('Erro ao carregar eventos');
                }
            } catch (error) {
                console.error('Erro ao carregar eventos:', error);
                updateSyncStatus(false);
                // Tenta carregar do localStorage como fallback
                loadFromLocalStorage();
            } finally {
                hideLoading();
            }
        }

        // Fun√ß√£o para salvar membro no Google Sheets
        async function saveMember(memberData) {
            try {
                showButtonLoading(memberSubmitBtn, true);
                
                const response = await fetch(SHEET_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'addMember',
                        data: memberData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showMessage('Membro cadastrado com sucesso! Todos ver√£o esta atualiza√ß√£o.', 'success');
                    await loadMembers(); // Recarrega a lista
                    return true;
                } else {
                    throw new Error(result.error || 'Erro ao salvar membro');
                }
            } catch (error) {
                console.error('Erro ao salvar membro:', error);
                showMessage('Erro ao cadastrar membro. Tentando salvar localmente...', 'error');
                // Fallback para localStorage
                saveMemberToLocalStorage(memberData);
                return false;
            } finally {
                showButtonLoading(memberSubmitBtn, false);
            }
        }

        // Fun√ß√£o para salvar evento no Google Sheets
        async function saveEvent(eventData) {
            try {
                showButtonLoading(eventSubmitBtn, true);
                
                const response = await fetch(SHEET_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'addEvent',
                        data: eventData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showMessage('Evento cadastrado com sucesso! Todos ver√£o esta atualiza√ß√£o.', 'success');
                    await loadEvents(); // Recarrega a lista
                    return true;
                } else {
                    throw new Error(result.error || 'Erro ao salvar evento');
                }
            } catch (error) {
                console.error('Erro ao salvar evento:', error);
                showMessage('Erro ao cadastrar evento. Tentando salvar localmente...', 'error');
                // Fallback para localStorage
                saveEventToLocalStorage(eventData);
                return false;
            } finally {
                showButtonLoading(eventSubmitBtn, false);
            }
        }

        // ========== FALLBACK LOCALSTORAGE ==========

        function saveMemberToLocalStorage(memberData) {
            const localMembers = JSON.parse(localStorage.getItem('network_members') || '[]');
            memberData.id = Date.now();
            localMembers.push(memberData);
            localStorage.setItem('network_members', JSON.stringify(localMembers));
            members.push(memberData);
            renderMembers();
            showMessage('Membro salvo localmente. Ser√° sincronizado quando online.', 'warning');
        }

        function saveEventToLocalStorage(eventData) {
            const localEvents = JSON.parse(localStorage.getItem('network_events') || '[]');
            eventData.id = Date.now();
            localEvents.push(eventData);
            localStorage.setItem('network_events', JSON.stringify(localEvents));
            events.push(eventData);
            renderEvents();
            showMessage('Evento salvo localmente. Ser√° sincronizado quando online.', 'warning');
        }

        function loadFromLocalStorage() {
            const localMembers = JSON.parse(localStorage.getItem('network_members') || '[]');
            const localEvents = JSON.parse(localStorage.getItem('network_events') || '[]');
            
            if (localMembers.length > 0) {
                members = localMembers;
                renderMembers();
            }
            
            if (localEvents.length > 0) {
                events = localEvents;
                renderEvents();
            }
        }

        // ========== FUN√á√ïES DE RENDERIZA√á√ÉO ==========

        function renderMembers() {
            membersList.innerHTML = '';
            if (members.length === 0) {
                membersList.innerHTML = '<p style="text-align: center; grid-column: 1/-1;">Nenhum membro cadastrado ainda.</p>';
                return;
            }
            
            members.forEach(member => {
                const memberCard = document.createElement('div');
                memberCard.className = 'card';
                memberCard.innerHTML = `
                    <div class="card-image">
                        <img src="${member.photo || 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'}" alt="${member.name}" loading="lazy">
                    </div>
                    <div class="card-header">
                        <h3>${member.name}</h3>
                        <span class="member-role">${member.role}</span>
                    </div>
                    <div class="card-body">
                        <p><strong>Email:</strong> ${member.email}</p>
                        ${member.phone ? `<p><strong>Telefone:</strong> ${member.phone}</p>` : ''}
                        <p>${member.bio}</p>
                    </div>
                `;
                membersList.appendChild(memberCard);
            });
        }

        function renderEvents() {
            eventsList.innerHTML = '';
            if (events.length === 0) {
                eventsList.innerHTML = '<p style="text-align: center; grid-column: 1/-1;">Nenhum evento cadastrado ainda.</p>';
                return;
            }
            
            events.forEach(event => {
                const eventDate = new Date(event.date);
                const formattedDate = eventDate.toLocaleDateString('pt-BR');
                
                const eventCard = document.createElement('div');
                eventCard.className = 'card';
                eventCard.innerHTML = `
                    <div class="card-image">
                        <img src="${event.photos && event.photos[0] ? event.photos[0] : 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'}" alt="${event.title}" loading="lazy">
                    </div>
                    <div class="card-header">
                        <h3>${event.title}</h3>
                        <div class="event-date">
                            <span>${formattedDate}</span> ‚Ä¢ <span>${event.time}</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <p><strong>Local:</strong> ${event.location}</p>
                        <p>${event.description}</p>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-success btn-participate" data-event-id="${event.id}">Participar</button>
                    </div>
                `;
                
                eventsList.appendChild(eventCard);
            });

            document.querySelectorAll('.btn-participate').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const eventId = parseInt(this.getAttribute('data-event-id'));
                    const event = events.find(ev => ev.id === eventId);
                    participateInEvent(event);
                });
            });
        }

        // ========== FUN√á√ïES AUXILIARES ==========

        function updateSyncStatus(online) {
            isOnline = online;
            if (online) {
                syncStatus.innerHTML = '<span>üîµ</span> Conectado';
                syncStatus.classList.remove('offline');
            } else {
                syncStatus.innerHTML = '<span>üî¥</span> Offline';
                syncStatus.classList.add('offline');
            }
        }

        function showLoading(message = 'Carregando...') {
            let overlay = document.getElementById('loadingOverlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = 'loadingOverlay';
                overlay.className = 'loading-overlay';
                document.body.appendChild(overlay);
            }
            overlay.innerHTML = `<div>${message}</div>`;
            overlay.style.display = 'flex';
        }

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.style.display = 'none';
            }
        }

        function showButtonLoading(button, loading) {
            const span = button.querySelector('span');
            const loadingDiv = button.querySelector('.btn-loading');
            
            if (loading) {
                span.style.display = 'none';
                loadingDiv.style.display = 'block';
                button.disabled = true;
            } else {
                span.style.display = 'block';
                loadingDiv.style.display = 'none';
                button.disabled = false;
            }
        }

        function showMessage(message, type = 'success') {
            const messageDiv = document.createElement('div');
            messageDiv.className = `global-notification ${type}`;
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#2ecc71' : type === 'error' ? '#e74c3c' : '#f39c12'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 4px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => messageDiv.remove(), 300);
            }, 5000);
        }

        function participateInEvent(event) {
            showMessage(`Voc√™ se inscreveu para participar do evento: ${event.title}`, 'success');
        }

        // ========== CONFIGURA√á√ÉO DE EVENTOS ==========

        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabId}-form`) {
                            content.classList.add('active');
                        }
                    });
                });
            });

            // Member form submission
            memberForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const memberData = {
                    name: document.getElementById('memberName').value,
                    email: document.getElementById('memberEmail').value,
                    phone: document.getElementById('memberPhone').value,
                    role: document.getElementById('memberRole').value,
                    bio: document.getElementById('memberBio').value,
                    photo: 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60',
                    timestamp: new Date().toISOString()
                };
                
                await saveMember(memberData);
                memberForm.reset();
                document.getElementById('memberPhotoPreview').innerHTML = '<div class="placeholder">Foto do Membro</div>';
            });

            // Event form submission
            eventForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const eventData = {
                    title: document.getElementById('eventTitle').value,
                    date: document.getElementById('eventDate').value,
                    time: document.getElementById('eventTime').value,
                    location: document.getElementById('eventLocation').value,
                    description: document.getElementById('eventDescription').value,
                    timestamp: new Date().toISOString()
                };
                
                await saveEvent(eventData);
                eventForm.reset();
            });

            // Mobile menu
            document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
                document.querySelector('nav ul').classList.toggle('show');
            });

            // Smooth scrolling
            document.querySelectorAll('nav a').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId !== '#') {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80,
                                behavior: 'smooth'
                            });
                            document.querySelector('nav ul').classList.remove('show');
                        }
                    }
                });
            });
        }

        // ========== INICIALIZA√á√ÉO ==========

        async function initializeApp() {
            setupEventListeners();
            await loadMembers();
            await loadEvents();
            
            // Atualiza a cada 30 segundos
            setInterval(async () => {
                await loadMembers();
                await loadEvents();
            }, 30000);
        }

        // Inicia a aplica√ß√£o
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>

